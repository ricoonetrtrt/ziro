const axios = require('axios');

module.exports.config = {
  name: "شخصيتي",
  version: "1.0.0",
  credits: "August Quinn",
  description: "احصل على وصف وسمات لنوع شخصية MBTI معين",
  commandCategory: "استرجاع المعلومات",
  usages: ["/mbti [نوع الشخصية]"],
  cooldowns: 5,
};

module.exports.run = async ({ api, event, args }) => {
  const baseURL = "https://mbti.august-api.repl.co";
  const personalityType = args[0]?.toUpperCase();

  if (!personalityType) {
    return api.sendMessage("يوجد 16 نوعًا متميزًا من الشخصيات يتكون كل منها من خصائص مختلفة فريدة لذلك النوع. ما هو نوعك؟\n\nESTP: أفضل اتباع نهج منظم ومخطط له في الحياة. أنا منظم وفعال في مهمتي، وأقدر العمل والمغامرة.\n\nISFP: أفضل نهجًا أكثر تلقائية ومرونة في الحياة. أنا منفتح الذهن وقابل للتكيف مع التغيير، وأقدر الإبداع والتعبير عن الذات.\n\nISFJ: أفضل اتباع نهج منظم ومخطط له في الحياة. أنا منظم وفعال في مهمتي، وأقدر الاستقرار والأمان.\n\nINFJ: أفضل نهجًا أكثر تلقائية ومرونة في الحياة. أنا منفتح الذهن وقابل للتكيف مع التغيير، وأقدر الإبداع والأصالة.\n\nINTP: أنا أركز في الأساس على الحقائق والبيانات. أفضل التعلم من خلال حواسي وأشعر بالراحة مع المعلومات الملموسة، وأستمتع بحل الألغاز وإيجاد الحلول المنطقية.\n\nISTJ: أنا أركز في الأساس على الأفكار والمفاهيم. أفضل التعلم من خلال التفكير المجرّد وأشعر بالراحة مع المعلومات النظرية، وأقدر الدقة والاهتمام بالتفاصيل.\n\nENTP: أتخذ القرارات بناءً على المنطق والعقل. أنا موضوعي وحيادي في أحكامي، وأستمتع بالمناظرة وتحدي الأفكار، وأقدر التحفيز الفكري.\n\nESFP: أتخذ القرارات بناءً على المشاعر والقيم. أنا موضوعي ورحيم في أحكامي، وأقدر الوئام والتواصل الاجتماعي، وأستمتع بالعيش في اللحظة الحالية.\n\nENTJ: أفضل اتباع نهج منظم ومخطط له في الحياة. أنا منظم وفعال في مهمتي، وأقدر القيادة والسيطرة، وأستمتع باتخاذ القرارات وتولي المسؤولية.\n\nESFJ: أفضل نهجًا أكثر تلقائية ومرونة في الحياة. أنا منفتح الذهن وقابل للتكيف مع التغيير، وأقدر التعاون والعمل الجماعي، وأستمتع بمساعدة الآخرين وجعلهم يشعرون بالراحة.\n\nINFP: أنا أركز في الأساس على المشاعر والقيم. أنا موضوعي ورحيم في أحكامي، وأقدر الأصالة والتعبير عن الذات، وأستمتع باستكشاف عالمي الداخلي وفهم الآخرين.\n\nINTJ: أنا أركز في الأساس على الأفكار والمفاهيم. أفضل التعلم من خلال التفكير المجرّد وأشعر بالراحة مع المعلومات النظرية، وأقدر التحفيز الفكري والتحليل، وأستمتع بخلق أفكار جديدة وتطوير النظريات.\n\nISTP: أتخذ القرارات بناءً على المنطق والعقل. أنا موضوعي وحيادي في أحكامي، وأستمتع بحل المشكلات وإيجاد الحلول العملية، وأقدر الكفاءة وإنجاز الأمور.\n\nISFP: أتخذ القرارات بناءً على المشاعر والقيم. أنا موضوعي ورحيم في أحكامي، وأقدر الوئام والأصالة، وأستمتع بتجربة أشياء جديدة والتعبير عن نفسي بشكل إبداعي.\n\nENFP: أفضل نهجًا أكثر تلقائية ومرونة في الحياة. أنا منفتح الذهن وقابل للتكيف مع التغيير، وأقدر الخيال والاستكشاف، وأستمتع بالتواصل مع الآخرين وإلهام الإبداع.\n\nESTJ: أفضل اتباع نهج منظم ومخطط له في الحياة. أنا منظم وفعال في مهمتي، وأقدر التقاليد والنظام، وأستمتع بالقيادة وتنفيذ الحلول العملية.", event.threadID, event.messageID);
  }

  try {
    const response = await axios.get(`${baseURL}/mbti/${personalityType}`);
    const { type, description, traits } = response.data;

    const resultMessage = `النوع: ${type}\nالوصف: ${description}\n\nالسمات: ${traits}`;

    api.sendMessage(resultMessage, event.threadID, event.messageID);
  } catch (error) {
    console.error('ERROR', error.response?.data || error.message);
    api.sendMessage('حدث خطأ أثناء معالجة الطلب. الرجاء المحاولة مرة أخرى لاحقًا.', event.threadID, event.messageID);
  }
};